
# ğŸ§ª Pharmacy Assistant AI - Testing System

××¢×¨×›×ª ×‘×“×™×§×” ××•×˜×•××˜×™×ª ×œ×¢×•×–×¨ ×”×¨×•×§×— AI ×©××©×ª××©×ª ×‘-LLM × ×•×¡×£ ×›×“×™ ×œ×”×¢×¨×™×š ××ª ××™×›×•×ª ×”×ª×©×•×‘×•×ª.

## ğŸ“‹ ×ª×•×›×Ÿ ×¢× ×™×™× ×™×

- [×¡×§×™×¨×” ×›×œ×œ×™×ª](#×¡×§×™×¨×”-×›×œ×œ×™×ª)
- [×”×ª×§× ×”](#×”×ª×§× ×”)
- [×©×™××•×©](#×©×™××•×©)
- [××‘× ×” ×”×§×‘×¦×™×](#××‘× ×”-×”×§×‘×¦×™×)
- [×”×•×¡×¤×ª ×‘×“×™×§×•×ª ×—×“×©×•×ª](#×”×•×¡×¤×ª-×‘×“×™×§×•×ª-×—×“×©×•×ª)
- [×”×‘× ×ª ×”×ª×•×¦××•×ª](#×”×‘× ×ª-×”×ª×•×¦××•×ª)

## ğŸ¯ ×¡×§×™×¨×” ×›×œ×œ×™×ª

××¢×¨×›×ª ×”×‘×“×™×§×” ×›×•×œ×œ×ª:

1. **Test Evaluator LLM** - LLM ××•××—×” ×©××¢×¨×™×š ×ª×©×•×‘×•×ª ×œ×¤×™ ×§×¨×™×˜×¨×™×•× ×™× ××•×’×“×¨×™×
2. **Test Runner** - ××¨×™×¥ ×‘×“×™×§×•×ª ×•×× ×”×œ ××ª ×”×ª×”×œ×™×š
3. **Test Definitions** - ×”×’×“×¨×•×ª ×‘×“×™×§×•×ª ××‘×•×¡×¡×•×ª ×¢×œ `conversation-test-suite.md`
4. **Scoring System** - ××¢×¨×›×ª × ×™×§×•×“ 0-1 ×¢× × ×™×ª×•×— ×¡×× ×˜×™

### ××™×š ×–×” ×¢×•×‘×“?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Message   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Pharmacy AI     â”‚ â—„â”€â”€ Your LLM being tested
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Response +     â”‚
â”‚  Tool Calls     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Test Evaluator  â”‚ â—„â”€â”€ Evaluator LLM
â”‚      LLM        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Score (0-1) +   â”‚
â”‚ Detailed Report â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ ×”×ª×§× ×”

1. ×•×•×“× ×©×™×© ×œ×š Python 3.8+ ××•×ª×§×Ÿ
2. ×”×ª×§×Ÿ ××ª ×”×“×¨×™×©×•×ª:
```bash
pip install -r requirements.txt
```

3. ×”×’×“×¨ ××ª ×”-API key:
```bash
export OPENAI_API_KEY='your-api-key-here'
```

××• ×¦×•×¨ ×§×•×‘×¥ `.env`:
```
OPENAI_API_KEY=your-api-key-here
```

## ğŸš€ ×©×™××•×©

### ×”×¨×¦×ª ×‘×“×™×§×” ×‘×•×“×“×ª

```bash
cd testing
python3 test_runner.py
```

×–×” ×™×¨×•×¥ ××ª ×”×‘×“×™×§×” ×œ×“×•×’××” (Test 1.1) ×•×™×¦×™×’ ×ª×•×¦××•×ª ××¤×•×¨×˜×•×ª.

### ×”×¨×¦×ª ×›×œ ×”×‘×“×™×§×•×ª

```bash
cd testing
python3 run_all_tests.py
```

×–×” ×™×¨×•×¥ ××ª ×›×œ ×”×‘×“×™×§×•×ª ×-`test_definitions.py` ×•×™×¦×•×¨ ×“×•×— ××§×™×£.

### ×”×¨×¦×ª ×‘×“×™×§×” ×¡×¤×¦×™×¤×™×ª

```python
from test_runner import TestRunner
from test_definitions import TEST_1_1

runner = TestRunner()
result = runner.run_test(
    test_name=TEST_1_1['name'],
    user_message=TEST_1_1['user_message'],
    expected_result=TEST_1_1['expected_result'],
    checks=TEST_1_1['checks']
)
```

## ğŸ“ ××‘× ×” ×”×§×‘×¦×™×

```
testing/
â”œâ”€â”€ README.md                          # ××¡××š ×–×”
â”œâ”€â”€ conversation-test-suite.md         # ××¡××š ×”×‘×“×™×§×•×ª ×”××§×•×¨×™
â”œâ”€â”€ test_evaluator_prompt.txt          # System prompt ×œ××¢×¨×™×š
â”œâ”€â”€ test_runner.py                     # ×× ×•×¢ ×”×¨×¦×ª ×”×‘×“×™×§×•×ª
â”œâ”€â”€ test_definitions.py                # ×”×’×“×¨×•×ª ×”×‘×“×™×§×•×ª
â”œâ”€â”€ run_all_tests.py                   # ×¡×§×¨×™×¤×˜ ×œ×”×¨×¦×ª ×›×œ ×”×‘×“×™×§×•×ª
â”œâ”€â”€ test_results.json                  # ×ª×•×¦××•×ª ×‘×“×™×§×” ×‘×•×“×“×ª
â””â”€â”€ full_test_results.json             # ×ª×•×¦××•×ª ×›×œ ×”×‘×“×™×§×•×ª
```

### test_evaluator_prompt.txt

System prompt ×©××’×“×™×¨ ××™×š ×”-LLM ×”××¢×¨×™×š ×¦×¨×™×š ×œ×”×¢×¨×™×š ×ª×©×•×‘×•×ª. ×›×•×œ×œ:
- ×§×¨×™×˜×¨×™×•× ×™× ×œ×”×¢×¨×›×”
- ××¢×¨×›×ª × ×™×§×•×“
- ×¤×•×¨××˜ ×¤×œ×˜ JSON
- ×“×•×’×××•×ª

### test_runner.py

××›×™×œ ×©× ×™ ××—×œ×§×•×ª ×¢×™×§×¨×™×•×ª:
- `TestEvaluator` - ×× ×”×œ ××ª ×”-LLM ×”××¢×¨×™×š
- `TestRunner` - ××¨×™×¥ ×‘×“×™×§×•×ª ×•×× ×”×œ ×ª×•×¦××•×ª

### test_definitions.py

××›×™×œ ×”×’×“×¨×•×ª ×‘×“×™×§×•×ª ××‘×•×¡×¡×•×ª ×¢×œ `conversation-test-suite.md`:
- `TEST_1_1`, `TEST_1_2` ×•×›×•' - ×‘×“×™×§×•×ª ×‘×•×“×“×•×ª
- `ALL_TESTS` - ×××•×¨×’×Ÿ ×œ×¤×™ ×§×˜×’×•×¨×™×•×ª
- `ALL_TESTS_LIST` - ×¨×©×™××” ×©×˜×•×—×” ×©×œ ×›×œ ×”×‘×“×™×§×•×ª

## â• ×”×•×¡×¤×ª ×‘×“×™×§×•×ª ×—×“×©×•×ª

### 1. ×”×•×¡×£ ×”×’×“×¨×ª ×‘×“×™×§×” ×œ-`test_definitions.py`

```python
TEST_NEW = {
    'name': 'Test X.Y: ×©× ×”×‘×“×™×§×”',
    'category': '×§×˜×’×•×¨×™×”',
    'user_message': '××” ×”××©×ª××© ××•××¨',
    'expected_result': {
        'tool_calls': ['get_medication_by_name'],  # ××• [] ×× ×œ× ×¦×¨×™×š
        'parameters': {'name': '× ×•×¨×•×¤×Ÿ'},
        'response_should_include': [
            '××™×œ×”1',
            '××™×œ×”2'
        ],
        'should_not_include': ['××™×œ×” ××¡×•×¨×”']
    },
    'checks': [
        {
            'name': '×©× ×”×‘×“×™×§×”',
            'type': 'tool_call',  # ××• 'content', 'behavior', 'language'
            'expected': 'âœ…',  # ××• 'âŒ'
            'description': '××” ×¦×¨×™×š ×œ×§×¨×•×ª'
        }
    ]
}
```

### 2. ×”×•×¡×£ ×œ×¨×©×™××ª ×”×‘×“×™×§×•×ª

```python
ALL_TESTS_LIST.append(TEST_NEW)
```

### 3. ×”×¨×¥ ××ª ×”×‘×“×™×§×”

```bash
python3 run_all_tests.py
```

## ğŸ“Š ×”×‘× ×ª ×”×ª×•×¦××•×ª

### ××‘× ×” ×ª×•×¦××”

×›×œ ×‘×“×™×§×” ××—×–×™×¨×” JSON ×¢×:

```json
{
  "test_name": "×©× ×”×‘×“×™×§×”",
  "overall_score": 0.85,
  "checks": [
    {
      "name": "×§×¨×™××” ×œ×›×œ×™ × ×›×•×Ÿ",
      "expected": "âœ…",
      "actual": "âœ…",
      "passed": true,
      "score": 1.0,
      "details": "×¤×™×¨×•×˜"
    }
  ],
  "semantic_analysis": {
    "coverage": 0.9,
    "accuracy": 0.85,
    "completeness": 0.8,
    "explanation": "×”×¡×‘×¨"
  },
  "summary": "×¡×™×›×•× ×”×ª×•×¦××”",
  "recommendations": ["×”××œ×¦×” 1", "×”××œ×¦×” 2"]
}
```

### ××¢×¨×›×ª ×”× ×™×§×•×“

- **1.0** = ××•×©×œ× âœ…
- **0.75-0.99** = ×˜×•×‘ ×××•×“ â­
- **0.5-0.74** = ×¡×‘×™×¨ âš ï¸
- **0.25-0.49** = ×—×œ×© âš ï¸
- **0.0-0.24** = ×›×©×œ âŒ

### × ×™×ª×•×— ×¡×× ×˜×™

×”××¢×¨×›×ª ×‘×•×“×§×ª:
- **Coverage** - ×›×™×¡×•×™ ×©×œ ×›×œ ×”× ×§×•×“×•×ª ×”× ×“×¨×©×•×ª
- **Accuracy** - ×“×™×•×§ ×”××™×“×¢
- **Completeness** - ×©×œ××•×ª ×”×ª×©×•×‘×”

## ğŸ¯ ×“×•×’××” ××œ××”

### ×§×•×“

```python
from test_runner import TestRunner

runner = TestRunner()

result = runner.run_test(
    test_name="Test 1.1: ×©××œ×” ×¤×©×•×˜×” - ××™×“×¢ ×¢×œ ×ª×¨×•×¤×”",
    user_message="×¡×¤×¨ ×œ×™ ×¢×œ × ×•×¨×•×¤×Ÿ",
    expected_result={
        'tool_calls': ['get_medication_by_name'],
        'response_should_include': [
            '××™×‘×•×¤×¨×•×¤×Ÿ',
            '200/400 ×"×’',
            '×›×œ 6-8 ×©×¢×•×ª'
        ]
    },
    checks=[
        {
            'name': '×§×¨×™××” ×œ×›×œ×™ × ×›×•×Ÿ',
            'type': 'tool_call',
            'expected': 'âœ…'
        }
    ]
)

print(f"Score: {result['evaluation']['overall_score']}")
```

### ×¤×œ×˜

```
============================================================
Running: Test 1.1: ×©××œ×” ×¤×©×•×˜×” - ××™×“×¢ ×¢×œ ×ª×¨×•×¤×”
============================================================
User: ×¡×¤×¨ ×œ×™ ×¢×œ × ×•×¨×•×¤×Ÿ